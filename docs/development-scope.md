# 開発範囲仕様書

> **🔄 Godot移行完了**: Unity版からGodot 4.x版への移行が完了し、以下の機能がすべて実装済みです。

## Godot版実装完了機能

### ✅ 完全実装済み機能

#### バトルシステム（`res/Scripts/systems/battle_system.gd`）
- **2人パーティ制**: 固定 2 人編成による戦略的バトル ✅
- **ターン制コマンドバトル**: 明確な戦術選択と結果予測 ✅
- **関係値連動技**: 共闘技・対立技の発動条件実装 ✅
- **敵AIシステム**: シンプルな AI 行動パターン ✅
- **Godot実装**: BattleSystem クラス + Battle.tscn ✅

#### 関係値管理システム（`res/Scripts/systems/relationship.gd`）
- **3段階システム**: 対立/通常/親密の明確な関係性管理 ✅
- **数値管理**: 内部数値、メニューで静かに表示 ✅
- **戦闘連動**: 共闘技（親密）、対立技（対立、主にソウマ限定）✅
- **推奨ペア**: 専用イベント・エンディング CG 有り ✅
- **Godot実装**: RelationshipSystem クラス + Signal 通信 ✅

#### UIシステム（`res/Scripts/ui/`）
- **ダイアログ表示**: タイピング効果付きテキスト表示 ✅
- **選択肢システム**: 条件判定付き選択肢パネル ✅
- **エフェクト統合**: パーティクル・フラッシュ・カメラ揺れ ✅
- **デバッグ機能**: リアルタイム関係値操作・テスト機能 ✅
- **Godot実装**: Control + Signal による統合 UI ✅

## 🚀 「願い石と僕らの旅路」開発計画

### Phase 2: コアストーリー実装
#### メインキャラクター実装
- **4人編成**: ソウマ、ユズキ、レツジ、カイの完全実装
- **初期関係値**: ソウマ-カイ -25、他は親密寄り設定
- **推奨ペアイベント**: ソウマ×ユズキ、ソウマ×レツジ、ソウマ×カイ
- **優先度**: 最高（体験版コア）

#### 願い石ストーリー
- **基本設定**: 願い石の謎、ハカセの封印、ケンゴの失踪
- **AIリラ関連**: 暴走事故、フェンリル（リゼルの召喚獣）の死
- **物語の核心**: 推しと旅をする楽しさ、関係性の変化
- **優先度**: 高（ゲームの意味づけ）

#### シナリオシステム
- **ストーリーデータ**: 外部ファイルによるシナリオ管理
- **キャラクター立ち絵**: アート素材の統合
- **ボイス対応**: 音声再生システムの実装
- **優先度**: 中（ゲーム体験向上）

### Phase 3: 高度なシーン遷移システム（✅完了）
#### シーン遷移機能
- **SceneTransitionManager**: 高度な遷移エフェクト（フェード、スライド、ディゾルブ等）✅
- **遷移履歴管理**: シーン履歴スタックによる戻る機能 ✅
- **非線形ナビゲーション**: 任意のシーンへの直接ジャンプ ✅
- **優先度**: 高（ゲーム体験の核心）

#### シナリオファイルベース管理
- **ScenarioLibrary**: 統合ライブラリ管理システム ✅
- **設定ファイル管理**: library_config.json による設定駆動 ✅
- **依存関係管理**: シナリオ間の依存関係とアンロック条件 ✅
- **優先度**: 高（開発効率向上）

#### 複数シーンファイル管理
- **シナリオシーケンス**: 複数シナリオの順序付き統合 ✅
- **シナリオコレクション**: テーマ別シナリオグループ化 ✅
- **動的シーン統合**: ランタイムでのシーン統合・分離 ✅
- **優先度**: 高（拡張性確保）

#### 統合デバッグシステム
- **Phase3TestScene**: 全機能統合テスト UI ✅
- **GameManager統合**: 既存システムとの完全統合 ✅
- **リアルタイムテスト**: 開発中の動作確認システム ✅
- **優先度**: 中（開発効率）

### Phase 4: 配布・最適化
#### プラットフォーム最適化
- **モバイル対応**: Android・iOS 版の検討
- **Steam配布**: PC 配布パッケージング
- **パフォーマンス**: 低スペック端末での動作最適化
- **優先度**: 低（配布準備）

## ダンジョンシステム詳細仕様

### 7層構造システム
1. **自由選択**: プレイヤーの戦略選択、複数ルート分岐
2. **ギミック1**: 謎解き要素、2 回目以降は自由選択可
3. **強制戦闘**: 必須バトル、「にげる」コマンド使用可
4. **初回イベント**: 初回のみ特別イベント発生 → 以降は自由選択
5. **ギミック2**: 第二の謎解き、2 回目以降は自由選択可
6. **強制戦闘**: 必須バトル、「にげる」コマンド使用可
7. **ボス戦**: ダンジョンの最終戦、逃走不可

### 選択肢ベース進行システム
- **マップ非依存**: 伝統的なマップ移動ではなく選択肢で進行
- **ストーリー駆動**: イベントと関係値が進行に影響
- **リプレイ性**: 2 回目以降はギミックをスキップ可能
- **戦略的選択**: プレイヤーのリスク管理と報酬選択

### イベントシステム
- **ソウマ操作時のみ**: 選択肢が表示される主人公中心システム
- **関係値大幅変動**: ±25〜±100 の重要な決断イベント
- **仲間同士ペア**: 固定テキストで関係値変化のみ（選択肢なし）
- **シナリオ分岐**: 関係値が体験を大きく変える

## UI/UX仕様詳細

### バトルUIシステム
- **関係値常時表示**: バトル中は数値で明示的に表示
- **スキル色分け**: 白（通常）/青（魔法）/緑（共闘）/赤（対立）
- **直感的操作**: 使用不可スキルはグレーアウト表示
- **SP管理表示**: 戦闘ごとのリセット状態を視覚化

### 相関図システム
- **アクセス方法**: 拠点 NPC サイトウに話しかけると閲覧可能
- **推奨ペア表示**: 特別イベント有りの組み合わせにヒント表示
- **非推奨ペア**: 矢印なしで特別要素のない組み合わせを明示
- **関係値可視化**: 数値とグラフで現在の関係状態を表示
- **メタキャラ連携**: サイトウのガイダンスと解説

### メニューシステム
- **タイトル画面**: ニューゲーム/ロード/設定/ギャラリー
- **設定画面**: 音量調整・BGM/SE/ボイス個別設定
- **テキスト速度**: ダイアログ表示速度のカスタマイズ
- **ギャラリー**:（将来実装）エンディング CG・イベント回想

### テキストシステム
- **プロローグ**: 背景差し替え・キャラ立ち絵最大 2 人表示
- **テキストログ**: 過去の会話内容を閲覧可能
- **スキップ機能**: 既読部分の高速進行
- **タイピングエフェクト**: 自然なテキスト表示演出
